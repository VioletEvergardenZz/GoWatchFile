# 下一阶段执行计划（2026-02-17）

> 目标：在不扩张范围的前提下，完成“事件分析可观测 + 知识库可运营 + 文档可追溯”三条主线收口。

> 平台定位（当前口径）：运维事件分析与知识决策平台，文件监控上传为可选采集器。

## 0. 执行状态快照（已启动）

| 工作项 | 状态 | 输出物 |
| --- | --- | --- |
| 监控指标字典 v1 | 已完成 | `docs/05-指标与评估/监控指标字典-v1.md` |
| 告警阈值草案 v0.1 | 已完成 | `docs/05-指标与评估/指标告警阈值草案-v0.1.md` |
| 指标巡检脚本 | 已完成 | `go-watch-file/scripts/ops/check-metrics.ps1` |
| 上传压测脚本 | 已完成 | `go-watch-file/scripts/ops/upload-stress.ps1` |
| AI 回放脚本与手册 | 已完成 | `go-watch-file/scripts/ops/ai-replay.ps1`、`docs/03-告警与AI/AI回放验收手册.md` |
| 上传可靠性演练手册 | 已完成 | `docs/03-告警与AI/上传可靠性演练手册.md` |
| 阶段回归报告模板 | 已完成 | `docs/05-指标与评估/阶段回归报告模板-v1.md` |
| 知识库问答引用率门禁 | 已完成 | `go-watch-file/cmd/kb-eval/main.go`（`citation` 子命令） |
| 知识库指标看板 + 问答降级可视化 | 已完成 | `console-frontend/src/KnowledgeConsole.tsx`、`go-watch-file/internal/api/kb_handlers.go` |
| 真实环境演练报告 | 已完成（未通过） | `docs/05-指标与评估/阶段回归报告-2026-02-17.md` |

## 1. 本阶段范围（2~4 周）

### 1.1 必做（P0）
- 事件输入链路稳定性收口：覆盖文件上传、手动/API 输入路径的高压一致性验证。
- 指标落地收口：对接 `/metrics` 到监控系统，形成事件分析与决策闭环看板。
- AI 稳定性收口：覆盖 AI 成功/重试/降级/失败分类的回归样例
- 文档收口：配置、接口、运行手册、FAQ 与实际行为保持一致

### 1.2 优先（P1）
- 知识库运营闭环：复审队列规则、问答引用率监控、告警推荐命中复盘
- 端到端回归：导入 -> 发布 -> 检索 -> 问答 -> 推荐 -> 回滚全链路自动化

### 1.3 本阶段不做
- 多 Agent 完整控制面（跨集群调度、灰度发布、配置中心推拉）
- 路由编排 DSL 与复杂工作流
- 断点续传与分片上传

## 2. 里程碑进度

### 里程碑 A（第 1 周）
- 状态：`85%`
- 已完成：
  - 监控指标字典 v1
  - `/metrics` 告警阈值草案
  - 文档差异项（执行文档）补齐
- 待完成：
  - 将阈值草案同步到实际告警平台并开启观察模式

### 里程碑 B（第 2 周）
- 状态：`75%`
- 已完成：
  - 上传压测与 AI 回放自动化脚本
  - 可靠性演练手册与 AI 回放手册
- 待完成：
  - 修复回归报告中的阻断项（上传链路计数、AI 降级率、知识库命中/引用门禁）

### 里程碑 C（第 3~4 周）
- 状态：`92%`
- 已完成：
  - 知识库评估工具补充引用率门禁（`kb-eval citation`）
  - 控制面 MVP 设计草案（`docs/01-总览规划/控制面MVP设计草案.md`）
  - 控制面首批接口落地（Agent register/heartbeat/list 与 Task create/list/get/cancel/retry）
  - 控制面 SQLite 持久化与启动恢复（agents/tasks）
  - 控制面任务生命周期回放与指标门禁（online/backlog/timeout）
  - 控制面审计查询接口与控制台审计展示（按 resource/operator/action 过滤）
  - 知识库复盘汇总脚本（hitrate/citation/mttd）与报告输出标准化
- 待完成：
  - 命中率/引用率/MTTD 的实测复盘结果

## 3. 可交付物清单

1. 指标字典与告警阈值文档
2. 压测与故障演练报告
3. AI 回放与降级验证报告
4. 知识库运营复盘（命中率、引用率、MTTD 对比）
5. 更新后的部署/开发/运维文档

## 4. 验收标准（DoD）

1. 后端 `go test ./...` 全通过
2. 前端 `npm run build` 全通过
3. `/metrics` 指标可被抓取，关键指标有稳定数值
4. AI 分析失败时可降级返回且 `meta` 字段完整
5. 文档与接口/配置行为一致，无明显冲突项

## 5. 主要风险与应对

- 风险：监控阈值不合理导致误报
  - 应对：先以观察模式上线 1 周，再调阈值
- 风险：AI 外部服务波动导致分析质量不稳定
  - 应对：固定回放样例 + 降级结果模板 + 错误分类看板
- 风险：文档更新滞后导致执行偏差
  - 应对：每次功能合并必须同步文档 PR 清单

## 6. 下一阶段入口

- 可靠性与观测：`todo.md`（阶段 1）
- 知识库路线：`docs/04-知识库/运维知识库实施清单.md`
- 全局范围控制：`docs/01-总览规划/MVP范围控制.md`


## 7. 2026-02-17 进展更新（里程碑 B）
- 已完成：修复 Windows 路径穿越场景下上传链路阻断问题
- 当前状态：
  - 压测回放下上传链路计数已开始增长
  - `gwf_file_events_total` 与上传失败/重试计数不再固定为 0
- 里程碑 B 剩余阻断项：
  - AI 降级率仍高于目标（演练配置使用了不可达 AI 端点）
  - 知识库命中率与引用率门禁仍未完全通过

## 8. 2026-02-17 进展更新（知识库 ）
- 已完成：通过兜底分词打分修复知识库检索/问答门禁
- 验证结果：
  - `kb-eval hitrate`: `20/20 = 100%`
  - `kb-eval citation`: `20/20 = 100%`
- 当前阶段剩余主要阻断项：
  - AI 降级率门禁仍待关闭（需要可达 AI 端点并重新回放）

## 9. 2026-02-17 进展更新（AI 门禁闭环）
- 已完成：
  - 使用可达的本地 OpenAI 兼容端点重跑 `ai-replay.ps1`
  - 复核 `/metrics` 快照与 AI 结果计数
- 验证结果：
  - `ai-replay`: `total=3 success=3 degraded=0 degradedRatio=0.00`
  - `gwf_ai_log_summary_total{outcome="success"} = 3`
  - `gwf_ai_log_summary_total{outcome="degraded"} = 0`
  - `gwf_ai_log_summary_retry_total = 0`
- 里程碑 B 状态：
  - 上传链路阻断项：已关闭
  - 知识库命中/引用阻断项：已关闭
  - AI 降级率阻断项：已关闭
  - 总体进度：`100%`

## 10. 2026-02-17 进展更新（里程碑 C 启动）
- 已完成：
  - 新增控制面 MVP 设计草案，覆盖范围边界、v1 数据模型、API 草案、指标与 DoD
- 输出：
  - `docs/01-总览规划/控制面MVP设计草案.md`
- 下一关注点：
  - 运行任务生命周期指标回放验证，并将控制面指标接入 `/metrics`

## 11. 2026-02-17 进展更新（控制面 API v1）
- 已完成：
  - 新增控制面接口：
    - `POST/GET /api/control/agents`
    - `GET /api/control/agents/{id}`
    - `POST /api/control/agents/{id}/heartbeat`
    - `POST /api/control/agents/{id}/drain`
    - `POST/GET /api/control/tasks`
    - `GET /api/control/tasks/{id}`
    - `POST /api/control/tasks/{id}/cancel`
    - `POST /api/control/tasks/{id}/retry`
  - 补充了 Agent/Task 生命周期 API 测试。
- 代码：
  - `go-watch-file/internal/api/control_handlers.go`
  - `go-watch-file/internal/api/control_handlers_test.go`
  - `go-watch-file/internal/api/server.go`
- 验证：
  - `cd go-watch-file && go test ./internal/api -count=1` 通过
  - `cd go-watch-file && go test ./... -count=1` 通过

## 12. 2026-02-18 进展更新（控制面任务闭环与指标门禁）
- 已完成：
  - 新增控制面任务分发与生命周期动作接口：
    - `POST /api/control/dispatch/pull`
    - `POST /api/control/tasks/{id}/ack`
    - `POST /api/control/tasks/{id}/progress`
    - `POST /api/control/tasks/{id}/complete`
    - `GET /api/control/tasks/{id}/events`
    - `GET /api/control/audit`
  - 控制面任务事件与审计落库（SQLite）：
    - `control_task_events`
    - `control_audit_logs`
  - 控制面指标接入 `/metrics` 并形成门禁覆盖（online/backlog/timeout）：
    - `gwf_control_agents_total` / `gwf_control_agents_online` / `gwf_control_agent_heartbeat_lag_seconds`
    - `gwf_control_task_backlog` / `gwf_control_tasks_total` / `gwf_control_task_timeout_total` / `gwf_control_task_duration_seconds`
  - 新增控制面回放脚本（用于验收与回归）：
    - `go-watch-file/scripts/ops/control-replay.ps1`
  - 更新指标巡检脚本并纳入控制面指标校验：
    - `go-watch-file/scripts/ops/check-metrics.ps1`
- 验证：
  - `cd go-watch-file && go test ./... -count=1` 通过

## 13. 2026-02-17 进展更新（控制面存储持久化）
- 已完成：
  - 新增基于 SQLite 的控制面存储，支持 agents/tasks 启动快照恢复
  - 新增持久化测试与恢复后序列连续性测试
- 代码：
  - `go-watch-file/internal/api/control_store.go`
  - `go-watch-file/internal/api/control_store_test.go`
  - `go-watch-file/internal/api/control_handlers.go`
  - `go-watch-file/internal/api/server.go`
- 行为：
  - 默认存储路径：`go-watch-file/data/control/control.db`
  - 可选覆盖：环境变量 `CONTROL_DATA_DIR`
  - 存储初始化或加载失败时会回退到内存模式。
- 验证：
  - `cd go-watch-file && go test ./internal/api -count=1` 通过
  - `cd go-watch-file && go test ./... -count=1` 通过

## 14. 2026-02-18 进展更新（控制面审计查询与控制台展示）
- 已完成：
  - 新增控制面审计查询接口：
    - `GET /api/control/audit?resourceType=&resourceId=&operator=&action=&limit=`
  - 控制面后端新增审计查询能力（SQLite）：
    - 支持按 `resourceType/resourceId/operator/action` 条件组合过滤
  - 控制台控制面页新增审计日志展示：
    - 任务维度审计展示（resource=task/{id}）
    - 支持与任务事件联动查看
- 代码：
  - `go-watch-file/internal/api/control_audit.go`
  - `go-watch-file/internal/api/control_store.go`
  - `go-watch-file/internal/api/control_dispatch_test.go`
  - `go-watch-file/internal/api/control_store_test.go`
  - `console-frontend/src/ControlConsole.tsx`
  - `console-frontend/src/console/dashboardApi.ts`
  - `console-frontend/src/types.ts`
- 验证：
  - `cd go-watch-file && go test ./... -count=1` 通过
  - `cd console-frontend && npm run build` 通过

## 15. 2026-02-18 进展更新（知识库复盘自动化）
- 已完成：
  - 新增知识库复盘汇总脚本：
    - `go-watch-file/scripts/ops/kb-recap.ps1`
  - 统一输出结构化结果文件：
    - `reports/kb-recap-result.json`
  - 将 `hitrate/citation/mttd` 三项评估收口为一次执行，减少手工复盘口径偏差
- 代码：
  - `go-watch-file/scripts/ops/kb-recap.ps1`
- 文档：
  - `go-watch-file/README.md`
  - `docs/02-开发运维/开发指南.md`
- 待补：
  - 在可达的真实/演练环境执行脚本并填充阶段实测结果

## 16. 2026-02-18 进展更新（控制面审计过滤与阶段复盘收口）
- 已完成：
  - 控制面审计接口支持时间范围过滤：
    - `GET /api/control/audit?from=&to=`
    - 支持 `RFC3339` 与 `YYYY-MM-DDTHH:mm` 两种时间格式
  - 控制台控制面页补齐审计筛选与导出能力：
    - 审计条件筛选：`operator/action/from/to`
    - 当前筛选条件导出：`JSON`
    - 审计明细 `detail_json` 可视化展示
  - 新增阶段一键复盘脚本（metrics + control + kb）：
    - `go-watch-file/scripts/ops/stage-recap.ps1`
- 文档更新：
  - `go-watch-file/README.md`
  - `docs/01-总览规划/控制面MVP设计草案.md`
  - `docs/02-开发运维/开发指南.md`

## 17. 2026-02-18 进展更新（阶段报告自动生成）
- 已完成：
  - 新增阶段报告生成脚本：
    - `go-watch-file/scripts/ops/stage-report.ps1`
  - 支持从 `stage-recap-result.json` 与 metrics 快照自动渲染中文 Markdown 回归报告
  - `stage-recap.ps1` 增补阶段输出字段（`stages[].output`），便于失败根因落档
- 作用：
  - 将“实测复盘结果”从手工整理改为脚本生成，降低回归报告口径偏差
- 文档更新：
  - `go-watch-file/README.md`
  - `docs/02-开发运维/开发指南.md`

## 18. 2026-02-18 进展更新（阶段复盘纳入 AI 回放）
- 已完成：
  - `stage-recap.ps1` 默认纳入 AI 回放阶段，并新增参数：
    - `-AIPathsFile`
    - `-AILimit`
    - `-SkipAIReplay`
  - 阶段复盘汇总结果补齐 AI 结构化输出：
    - `artifacts.aiReplayResult`
    - `aiReplay`（`total/success/degraded/degradedRatio`）
  - `stage-report.ps1` 已消费 `aiReplay` 结果，报告执行清单中的 AI 行可直接展示总量、成功数、降级数与降级率
- 自检产物：
  - `reports/stage-recap-selfcheck.json`
  - `reports/stage-report-selfcheck.md`
- 文档更新：
  - `go-watch-file/README.md`
  - `docs/02-开发运维/开发指南.md`

## 19. 2026-02-18 进展更新（全量阶段复盘实测与阻断项）
- 已完成：
  - 修复知识库复盘脚本参数传递缺陷（PowerShell 自动变量冲突）：
    - `go-watch-file/scripts/ops/kb-recap.ps1`
  - 在本地演练环境执行全量阶段复盘与报告生成：
    - `stage-recap.ps1`（`metrics + ai + control + kb`）
    - `stage-report.ps1`
- 本轮实测结果（`base=http://127.0.0.1:8080`）：
  - `metrics-check`：通过
  - `ai-replay`：通过（`total=3 success=0 degraded=3 degradedRatio=100%`）
  - `control-replay`：通过（`done=30/30 success=30 failed=0`）
  - `kb-recap`：未通过（`citation` 门禁失败）
  - 阶段结论：`allPassed=false`，暂不允许进入下一阶段
- 产物归档：
  - `reports/stage-recap-full-2026-02-18.json`
  - `reports/kb-recap-result.json`
  - `docs/05-指标与评估/阶段回归报告-2026-02-18.md`
- 当前阻断项：
  - AI 降级率门禁未达标（回放路径对应日志在当前环境不可达，导致 `request_error` 降级）
  - 知识库问答引用率门禁未达标（`/api/kb/ask` 返回“知识库中未找到可引用条目”）
- 下一步动作：
  - 在可达 AI 日志样本环境重跑 `ai-replay.ps1` 与 `stage-recap.ps1`
  - 补齐知识库可引用条目后重跑 `kb-eval citation` 与 `stage-recap.ps1`

## 20. 2026-02-18 进展更新（阶段前置自动化与门禁一致性）
- 已完成：
  - 新增阶段前置脚本：
    - `go-watch-file/scripts/ops/stage-prime.ps1`
  - `stage-recap.ps1` 增加可选前置阶段与参数：
    - `-AutoPrime`
    - `-PrimeDocsPath`
    - `-PrimeOperator`
    - `-PrimeApproveImported`
    - `-PrimeAISamplesDir`
    - `-PrimeUpdateAlertLogPaths`
    - `-PrimeOutputFile`
  - `stage-recap.ps1` 增加 AI 降级率门禁收口（与报告阈值一致）：
    - `-AIDegradedRatioTarget`（默认 `0.2`）
    - 当 `aiReplay.degradedRatio` 超阈值时，`ai-replay` 阶段标记失败并影响 `allPassed`
  - `stage-report.ps1` 增加“阶段预备”执行项展示，并读取 `gateTargets.aiDegradedRatio` 动态渲染 AI 门禁阈值
- 本轮复测结果（`base=http://127.0.0.1:8080`, `-AutoPrime`）：
  - `stage-prime`：通过（知识库导入/更新完成，AI 样本与告警日志路径已准备）
  - `kb-recap`：通过（`hitrate/citation/mttd` 全通过）
  - `ai-replay`：未通过门禁（`degradedRatio=100%`，超过 `20%` 阈值）
  - 阶段结论：`allPassed=false`（当前阻断项聚焦为 AI 可用性）
- 文档更新：
  - `go-watch-file/README.md`
  - `docs/02-开发运维/开发指南.md`

## 21. 2026-02-18 进展更新（虚拟机 API 500 排障与无 Token 模式收口）
- 已完成：
  - 后端 API 鉴权改为“默认可选”：
    - `API_AUTH_TOKEN` 为空、占位符（`${API_AUTH_TOKEN}`）或显式设置 `API_AUTH_DISABLED=true` 时，管理接口不再要求 token。
  - 仪表盘接口增强容错，避免运行态未就绪时直接返回 `500`：
    - `GET /api/dashboard`
    - `GET /api/dashboard?mode=light`
    - 运行态缺失时返回降级数据（`200`），并记录后端告警日志。
  - 健康检查接口增强容错：
    - `GET /api/health` 在运行态对象为空时仍返回 `200`（空快照）。
  - 阶段运维脚本与评估工具完成“无 Token 模式”兼容：
    - `ai-replay.ps1`
    - `control-replay.ps1`
    - `kb-recap.ps1`
    - `stage-prime.ps1`
    - `stage-recap.ps1`
    - `cmd/kb-eval`（`hitrate/citation`）
    - 以上脚本/命令在未开启鉴权时可直接不传 `-Token`。
- 新增测试：
  - `go-watch-file/internal/api/dashboard_handler_test.go`
  - 覆盖 `dashboard` 在 `handler=nil`、`fs=nil` 与 `mode=light` 场景的 `200` 降级返回。
- 回归结果：
  - `cd go-watch-file && go test ./... -count=1` 通过
  - `cd console-frontend && npm run build` 通过
- 虚拟机联调建议（保持与当前实现一致）：
  - 若暂不启用鉴权，确保环境变量满足以下任一条件：
    - `API_AUTH_TOKEN` 留空
    - 或设置 `API_AUTH_DISABLED=true`
  - 若前端仍提示“仪表盘加载失败（500）”，优先检查后端容器日志与 `config.runtime.yaml` 是否可读写，再复核 `/api/dashboard` 直接访问结果。

## 22. 2026-02-18 进展更新（文档口径全量同步）
- 已完成：
  - 统一更新仓库级与模块级 README，确保与当前代码行为一致：
    - API 鉴权“默认可选”
    - 仪表盘运行态未就绪时降级返回 `200`
    - 阶段脚本在未启用鉴权时可省略 `-Token`
  - 同步更新开发运维、FAQ、前后端联动、AI 回放、知识库验收等文档口径。
  - 新增仓库协作规范文档：
    - `AGENTS.md`
- 文档清单（本轮）：
  - `README.md`
  - `console-frontend/README.md`
  - `go-watch-file/README.md`
  - `docs/文档导航.md`
  - `docs/02-开发运维/开发指南.md`
  - `docs/02-开发运维/前后端联动说明.md`
  - `docs/02-开发运维/常见问题.md`
  - `docs/03-告警与AI/AI回放验收手册.md`
  - `docs/04-知识库/知识库端到端验收.md`
  - `docs/01-总览规划/控制面MVP设计草案.md`

## 23. 2026-02-19 进展更新（/metrics 阈值告警配置收口）
- 已完成：
  - 新增 Prometheus 告警规则模板（队列/失败率/AI 降级率）：
    - `go-watch-file/deploy/prometheus/gwf-alert-rules.yaml`
  - 增强指标巡检脚本阈值能力：
    - `go-watch-file/scripts/ops/check-metrics.ps1`
    - 新增参数：`-CheckThresholds`、`-FailOnWarning`
    - 新增退出码：`4=Critical`、`5=Warning 且启用 FailOnWarning`
- 文档更新：
  - `go-watch-file/README.md`
  - `docs/02-开发运维/开发指南.md`
  - `docs/05-指标与评估/指标告警阈值草案-v0.1.md`

## 24. 2026-02-19 进展更新（上传链路压测与故障注入报告收口）
- 已完成：
  - 新增上传复盘脚本（队列压测 + 可选故障窗口 + 恢复窗口）：
    - `go-watch-file/scripts/ops/upload-recap.ps1`
  - 支持输出结构化结果与 Markdown 报告：
    - `reports/upload-recap-result.json`
    - `docs/05-指标与评估/上传链路压测与故障注入报告-YYYY-MM-DD.md`
  - 支持三种故障模式：
    - `FaultMode=none`（仅压测）
    - `FaultMode=manual`（手工注入/恢复）
    - `FaultMode=command`（命令自动注入/恢复）
- 文档更新：
  - `docs/03-告警与AI/上传可靠性演练手册.md`
  - `go-watch-file/README.md`
  - `docs/02-开发运维/开发指南.md`

## 25. 2026-02-19 进展更新（AI 回放样例集与三门禁验收收口）
- 已完成：
  - `ai-replay.ps1` 增补结构一致性与错误分类覆盖率验收：
    - 新增参数：`-DegradedRatioTarget`、`-StructurePassRatioTarget`、`-ErrorClassCoverageTarget`、`-FailOnGate`
    - 新增输出：`structure.*`、`severity`、`errorClassCoverage`、`knownErrorClassRatio`、`gates.*`
    - 支持门禁失败返回退出码 `3`（启用 `-FailOnGate`）
  - `stage-recap.ps1` 纳入 AI 三门禁一致性校验：
    - 新增参数：`-AIStructurePassRatioTarget`、`-AIErrorClassCoverageTarget`
    - 门禁与 `gateTargets` 汇总同步到阶段结果 JSON
  - `stage-report.ps1` 新增 AI 结构通过率与错误分类覆盖率展示。
  - 新增 AI 回放样例集清单文档：
    - `docs/03-告警与AI/AI回放样例集清单.md`
- 文档更新：
  - `docs/03-告警与AI/AI回放验收手册.md`
  - `go-watch-file/README.md`
  - `docs/02-开发运维/开发指南.md`
- 结果：
  - `todo.md` 中“AI 回放样例集与降级结果验收（结构一致性 + 错误分类）”已标记完成。

## 26. 2026-02-19 进展更新（知识库命中率/引用率复盘与改进清单收口）
- 已完成：
  - 增强知识库复盘脚本，新增“指标门禁 + 改进清单”输出：
    - `go-watch-file/scripts/ops/kb-recap.ps1`
    - 新增参数：`-HitrateTarget`、`-MttdDropTarget`、`-FromResultFile`、`-ReportFile`
    - 新增输出：`commandPassed`、`analysis.targets`、`analysis.metrics`、`analysis.gates`、`analysis.improvements`
  - 支持离线复盘（基于已有 `kb-recap-result.json` 二次生成改进清单），用于无服务场景验收。
  - 生成知识库阶段复盘改进清单文档：
    - `docs/05-指标与评估/知识库命中率与引用率阶段复盘改进清单-2026-02-19.md`
  - `stage-recap.ps1` 对齐知识库门禁参数透传与汇总口径：
    - 新增参数：`-KBHitrateTarget`、`-KBMttdDropTarget`
    - `gateTargets` 新增：`kbHitrate`、`kbCitation`、`kbMttdDrop`
  - `stage-report.ps1` 对齐知识库动态阈值展示，并增加 MTTD 下降比例门禁行。
- 文档更新：
  - `go-watch-file/README.md`
  - `docs/02-开发运维/开发指南.md`
- 结果：
  - `todo.md` 中“完成知识库命中率/引用率阶段复盘与改进清单”已标记完成。

## 27. 2026-02-19 进展更新（阶段 0 基础验证脚本化）
- 已完成：
  - 新增基础验证脚本：
    - `go-watch-file/scripts/ops/basic-e2e.ps1`
  - 覆盖验证项：
    - `go test ./...`（可选 `-SkipGoTest`）
    - 单机端到端上传（创建样本文件 + `POST /api/manual-upload` + 上传指标增量校验）
    - 通知观测（仪表盘 `metricCards` 中“通知次数”增量，支持 `-RequireNotification`）
  - 支持输出产物：
    - `reports/basic-e2e-result.json`
    - `docs/05-指标与评估/基础验证报告-YYYY-MM-DD.md`（通过 `-ReportFile`）
- 文档更新：
  - `go-watch-file/README.md`
  - `docs/02-开发运维/开发指南.md`
- 当前状态：
  - 本地会话下 `http://127.0.0.1:8080` 不可达，脚本自检返回预期退出码 `2`（依赖服务不可达）。
  - `todo.md` 中“基础验证”已切换为进行中（`[-]`），待在可达环境完成一次实跑并回填报告后改为已完成。

## 28. 2026-02-19 进展更新（阶段 0 AI 基线验证脚本化）
- 已完成：
  - 新增 AI 基线验证脚本：
    - `go-watch-file/scripts/ops/ai-baseline.ps1`
  - 覆盖验证项：
    - 固定样例回放（复用 `ai-replay.ps1`）
    - `summary/severity/suggestions` 三项结构稳定性门禁
    - 兼容离线复核（`-FromResultFile`），用于服务不可达场景
  - 支持输出产物：
    - `reports/ai-baseline-result.json`
    - `docs/05-指标与评估/AI基线验证报告-YYYY-MM-DD.md`（通过 `-ReportFile`）
- 文档更新：
  - `go-watch-file/README.md`
  - `docs/02-开发运维/开发指南.md`
  - `docs/03-告警与AI/AI回放验收手册.md`
- 当前状态：
  - 已完成离线自检：`-FromResultFile ../reports/ai-replay-result.json`。
  - 当前仓库内历史 `ai-replay-result.json` 为旧口径结果（缺少 `structure.*` 与 `results[].structureIssues`），基线脚本按预期判定“结构证据不足”并失败。
  - `todo.md` 中“AI 基线验证”已切换为进行中（`[-]`），待在可达环境生成新口径回放结果后完成实跑并回填报告。

## 29. 2026-02-19 进展更新（上传可靠性 ETag 校验补齐）
- 已完成：
  - 上传链路新增 ETag 校验开关（静态配置）：
    - `upload_etag_verify_enabled`（配置项）
    - `UPLOAD_ETAG_VERIFY_ENABLED`（环境变量）
  - 上传实现新增本地 MD5 与 OSS ETag 比对逻辑（开启后生效）：
    - `go-watch-file/internal/oss/client.go`
  - 新增 ETag 相关单元测试：
    - `go-watch-file/internal/oss/client_test.go`
  - 补充配置加载测试（环境变量覆盖）：
    - `go-watch-file/internal/config/config_test.go`
- 文档更新：
  - `go-watch-file/config.yaml`
  - `go-watch-file/.env.example`
  - `go-watch-file/README.md`
  - `docs/02-开发运维/开发指南.md`
- 当前状态：
  - “重试策略完善（上限/退避）、断点续传/etag 校验”已进入进行中（`[-]`）。
  - 上限/退避 + ETag 校验已具备，断点续传能力仍待实现后再闭环该项。
